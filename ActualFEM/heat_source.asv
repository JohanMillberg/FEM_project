function f = heat_source(p,e,t,beta,gamma,M,xi)

b_vec = zeros(N,1);

for K = 1:size(t,2)
    nodes = t(1:3,K);
    x = p(1,nodes);
    y = p(2,nodes);
    [area_K, b, c] = hat_gradients(x,y);
    xc = mean(x); yc = mean(y);
    bK = source_term2(xc,yc)*area_K / 3;
    b_vec(nodes) = b_vec(nodes) + bK;
end

f = beta .* M * (xi-gamma.*xi.^2);